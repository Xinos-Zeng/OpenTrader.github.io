## é—®é¢˜ä¿®å¤è®°å½•

å¦‚æœä¿®å¤å®Œæˆï¼Œå°†å†…å®¹ç§»åˆ°å·²ä¿®å¤ä¸­ã€‚
ä¿®å¤åä¸éœ€è¦ä½ é‡å¯æœåŠ¡ï¼Œæˆ‘ä¼šè‡ªå·±é‡å¯ã€‚

### å¾…ä¿®å¤/ä¼˜åŒ–
ï¼ˆæ— ï¼‰

---

### å·²ä¿®å¤

**TqSim å›æµ‹æ•°æ®æ˜¾ç¤ºä¿®å¤** [åç«¯]
   - é—®é¢˜ï¼šå›æµ‹ç»“æœä¸­ç´¯è®¡ç›ˆäºã€æ€»ç›ˆäºã€æœ€å¤§å›æ’¤ç­‰æ•°æ®éƒ½æ˜¾ç¤ºä¸º 0
   - åŸå› ï¼š
     1. `api.close()` ä¹‹åå†è¯»å– `account` å¯¹è±¡ï¼Œæ­¤æ—¶æ•°æ®å·²æ— æ•ˆ
     2. `trade_pnl` é”™è¯¯åœ°ä½¿ç”¨ç´¯è®¡ç›ˆäºï¼Œè€Œéæœ¬æ¬¡äº¤æ˜“ç›ˆäº
   - ä¿®å¤ï¼š`AgentTrader/src/strategy/backtest.py`
     - åœ¨ `BacktestFinished` å¼‚å¸¸ä¸­ä¿å­˜ `final_balance` å’Œ `final_close_profit`
     - è·Ÿè¸ª `prev_close_profit` æ¥è®¡ç®—æ¯ç¬”äº¤æ˜“çš„çœŸå®ç›ˆäºï¼š`trade_pnl = current_close_profit - prev_close_profit`
     - æ–°å¢ `_calculate_stats_from_trades()` æ–¹æ³•ä½¿ç”¨ä¿å­˜çš„æ•°æ®è®¡ç®—ç»Ÿè®¡
     - `run_stream` å’Œ `run_stream_with_agent` å‡å·²æ›´æ–°

**å›æµ‹æ”¹ç”¨ TqSim æ¨¡æ‹Ÿäº¤æ˜“** [åç«¯]
   - é—®é¢˜ï¼šä¹‹å‰å›æµ‹åªä½¿ç”¨ TqSdk è·å– K çº¿æ•°æ®ï¼Œç›ˆäºè®¡ç®—æ˜¯æ‰‹åŠ¨å®ç°çš„ï¼ŒTqSdk æ—¥å¿—æ˜¾ç¤ºè´¦æˆ·æ•°æ®å…¨ä¸º 0
   - ä¿®å¤ï¼š`AgentTrader/src/strategy/backtest.py`
     - å¯¼å…¥å¹¶ä½¿ç”¨ `TqSim` æ¨¡æ‹Ÿè´¦æˆ·ï¼š`sim_account = TqSim(init_balance=init_balance)`
     - å°†æ—¥çº¿ï¼ˆ`60*60*24`ï¼‰æ”¹ä¸ºå°æ—¶çº¿ï¼ˆ`60*60`ï¼‰ï¼Œè§£å†³"æ—¥çº¿æ—¶é—´æˆ³ä¸åœ¨äº¤æ˜“æ—¶æ®µ"çš„ä¸‹å•å¤±è´¥é—®é¢˜
     - ä½¿ç”¨ `api.insert_order()` çœŸå®ä¸‹å•ï¼Œè€Œéæ‰‹åŠ¨è®¡ç®—ç›ˆäº
     - ä» `api.get_account()` å’Œ `api.get_position()` è·å–çœŸå®è´¦æˆ·æ•°æ®
     - `run_stream` å’Œ `run_stream_with_agent` å‡å·²æ›´æ–°
   - æ•ˆæœï¼šTqSdk æ—¥å¿—å°†æ˜¾ç¤ºçœŸå®çš„æ¨¡æ‹Ÿäº¤æ˜“æ•°æ®ï¼ˆä½™é¢ã€ç›ˆäºã€ä¿è¯é‡‘ç­‰ï¼‰

**ä¿¡æ¯æµå»¶è¿Ÿé—®é¢˜ - æµå¼ä¼ è¾“ä¼˜åŒ–** [åç«¯]
   - é—®é¢˜ï¼šå›æµ‹éœ€è¦ç­‰å¾…æ•´ä¸ªå›æµ‹å®Œæˆæ‰èƒ½æ¥æ”¶æ¶ˆæ¯æµï¼Œè€Œéé€æ­¥æµå¼
   - åŸå› ï¼šä¹‹å‰ä½¿ç”¨åŒæ­¥ `queue.Queue` é…åˆ `threading.Thread`ï¼Œåœ¨å¼‚æ­¥ç”Ÿæˆå™¨ä¸­æ²¡æœ‰æ­£ç¡®é‡Šæ”¾æ§åˆ¶æƒ
   - ä¿®å¤ï¼š`AgentTrader/src/api/routers/backtest.py`
     - æ”¹ç”¨ `asyncio.Queue` æ›¿ä»£åŒæ­¥é˜Ÿåˆ—
     - ä½¿ç”¨ `loop.call_soon_threadsafe()` çº¿ç¨‹å®‰å…¨åœ°å°†äº‹ä»¶æ”¾å…¥å¼‚æ­¥é˜Ÿåˆ—
     - ä½¿ç”¨ `asyncio.create_task()` åœ¨åå°è¿è¡Œå›æµ‹
     - æ¯æ¬¡ yield åæ·»åŠ  `await asyncio.sleep(0.01)` ç¡®ä¿æ•°æ®è¢«åˆ·æ–°å‘é€
     - ç§»é™¤äº†ä¸å†éœ€è¦çš„ `queue` å’Œ `threading` å¯¼å…¥

**Agent å·¥å…·è°ƒç”¨æ—¥å¿—å¢å¼º** [åç«¯]
   - é—®é¢˜ï¼šAgent è°ƒç”¨å·¥å…·æ—¶æ—¥å¿—ä¿¡æ¯ä¸å¤Ÿè¯¦ç»†
   - ä¿®å¤ï¼š`AgentTrader/src/agent/trading_agent.py`
     - å·¥å…·è°ƒç”¨æ—¥å¿—æ·»åŠ  emoji å›¾æ ‡ ğŸ”§
     - åˆ†è¡Œæ˜¾ç¤ºå·¥å…·åã€å‚æ•°ã€è¿”å›ç»“æœ
     - ç»“æœè¶…è¿‡500å­—ç¬¦æ—¶è‡ªåŠ¨æˆªå–å¹¶æ·»åŠ çœç•¥å·

**ç§»é™¤"æ¯æ¬¡äº¤æ˜“æ‰‹æ•°"é…ç½®** [å‰ç«¯]
   - é—®é¢˜ï¼šå›æµ‹ç•Œé¢ä¸éœ€è¦å†å±•ç¤º"æ¯æ¬¡äº¤æ˜“æ‰‹æ•°"é…ç½®é¡¹
   - ä¿®å¤ï¼š`OpenTrader/src/pages/backtest/BacktestStream.tsx`
     - ç§»é™¤äº† `config-row balance-position` ä¸­çš„"æ¯æ¬¡äº¤æ˜“æ‰‹æ•°"è¾“å…¥æ¡†
     - ä¿ç•™åç«¯å‚æ•°æ”¯æŒï¼ˆé»˜è®¤å€¼ä¸º1ï¼‰ï¼Œä¿æŒå‘åå…¼å®¹

**ç»¿è‰²æ•°å€¼å­—å·å¤ªå¤§** [å‰ç«¯]
   - é—®é¢˜ï¼šäº¤æ˜“ä¿¡å·çª—å£ä¸­ç»¿è‰²æ•°å€¼å­—å·å¤ªå¤§
   - ä¿®å¤ï¼š`BacktestStream.css` ä¸­ `.finance-value` æ·»åŠ  `font-size: 12px`

**ä»“ä½ç™¾åˆ†æ¯”æ§åˆ¶** [å‰ç«¯+åç«¯]
   - é—®é¢˜ï¼šåªæœ‰æ¯æ¬¡äº¤æ˜“æ‰‹æ•°è®¾ç½®ï¼Œç¼ºå°‘ä»“ä½ç™¾åˆ†æ¯”æ§åˆ¶ï¼›ä¹°å–åªèƒ½äº¤æ›¿è¿›è¡Œ
   - ä¿®å¤ï¼š
     - åç«¯æ–°å¢ `position_percent` å‚æ•°ï¼ˆ0-100%ï¼‰ï¼Œæ§åˆ¶æœ€å¤§å¯ç”¨èµ„é‡‘æ¯”ä¾‹
     - åç«¯å›æµ‹é€»è¾‘æ”¹ä¸ºï¼šæ”¯æŒè¿ç»­åŒå‘å¼€ä»“ï¼ˆåŠ ä»“ï¼‰ï¼Œä»“ä½ä¸è¶…è¿‡ `èµ„é‡‘*ç™¾åˆ†æ¯”/ä¿è¯é‡‘ç‡`
     - å‰ç«¯æ–°å¢"ä»“ä½æ¯”ä¾‹"è¾“å…¥æ¡†ï¼ˆå¸¦%åç¼€ï¼‰ï¼Œä¸åˆå§‹èµ„é‡‘åŒè¡Œ
     - é»˜è®¤åˆå§‹èµ„é‡‘æ”¹ä¸º 200,000
   - æ¶‰åŠæ–‡ä»¶ï¼š
     - `AgentTrader/src/api/routers/backtest.py`
     - `AgentTrader/src/strategy/backtest.py`
     - `OpenTrader/src/stores/backtestStore.ts`
     - `OpenTrader/src/pages/backtest/BacktestStream.tsx`
     - `OpenTrader/src/pages/backtest/BacktestStream.css`

**ä¿¡æ¯æµå»¶è¿Ÿé—®é¢˜** [åç«¯]
   - é—®é¢˜ï¼šå¯ç”¨ Agent åéœ€è¦ç­‰å¾…æ•´ä¸ªå›æµ‹å®Œæˆæ‰èƒ½æ¥æ”¶æ¶ˆæ¯æµ
   - åŸå› ï¼šåŸå®ç°å…ˆæ”¶é›†æ‰€æœ‰äº‹ä»¶åˆ°åˆ—è¡¨ï¼Œå†ç»Ÿä¸€å‘é€
   - ä¿®å¤ï¼šä½¿ç”¨ `queue.Queue` + åå°çº¿ç¨‹å®ç°çœŸæ­£çš„æµå¼ä¼ è¾“
     - å›æµ‹çº¿ç¨‹é€ä¸ªäº‹ä»¶æ”¾å…¥é˜Ÿåˆ—
     - SSE ç”Ÿæˆå™¨å®æ—¶ä»é˜Ÿåˆ—å–å‡ºå¹¶å‘é€
   - æ¶‰åŠæ–‡ä»¶ï¼š`AgentTrader/src/api/routers/backtest.py`

**ä»“ä½æ§åˆ¶åŠŸèƒ½** [å‰ç«¯+åç«¯]
   - é—®é¢˜ï¼šMAç­–ç•¥åªèƒ½æŒæœ‰1æ‰‹ï¼Œä¹°å–äº¤æ›¿è¿›è¡Œ
   - ä¿®å¤ï¼š
     - åç«¯ `/api/backtest/stream` æ–°å¢ `position_size` å‚æ•°
     - åç«¯ `BacktestConfig.volume` ä½¿ç”¨ `position_size` å€¼
     - å‰ç«¯ `backtestStore` æ–°å¢ `positionSize` é…ç½®ï¼ˆé»˜è®¤1æ‰‹ï¼‰
     - å‰ç«¯å›æµ‹é¡µé¢æ–°å¢"æ¯æ¬¡äº¤æ˜“æ‰‹æ•°"è¾“å…¥æ¡†ï¼ˆä¸åˆå§‹èµ„é‡‘åŒè¡Œï¼‰
   - æ¶‰åŠæ–‡ä»¶ï¼š
     - `AgentTrader/src/api/routers/backtest.py`
     - `OpenTrader/src/stores/backtestStore.ts`
     - `OpenTrader/src/pages/backtest/BacktestStream.tsx`
     - `OpenTrader/src/pages/backtest/BacktestStream.css`

**æ¶ˆæ¯æµè¯¦æƒ…å¼¹çª—** [å‰ç«¯]
   - é—®é¢˜ï¼šäº¤æ˜“ä¿¡å·çª—å£å¤ªå°ï¼Œä¸æ–¹ä¾¿æŸ¥çœ‹å¤šæ¡æ¶ˆæ¯
   - ä¿®å¤ï¼šæ–°å¢"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®ï¼Œç‚¹å‡»å¼¹å‡ºå…¨å±è¯¦æƒ…å¼¹çª—
     - å¼¹çª—æ˜¾ç¤ºæ‰€æœ‰äº¤æ˜“ä¿¡å·å’ŒAgentæ¶ˆæ¯
     - æ¯æ¡æ¶ˆæ¯æ˜¾ç¤ºæ—¶é—´ã€ä¿¡å·ã€ä»·æ ¼ã€ç›ˆäºç­‰ä¿¡æ¯
     - æ”¯æŒæ»šåŠ¨æŸ¥çœ‹å¤§é‡æ¶ˆæ¯
   - æ¶‰åŠæ–‡ä»¶ï¼š
     - `OpenTrader/src/pages/backtest/BacktestStream.tsx`
     - `OpenTrader/src/pages/backtest/BacktestStream.css`

**Agent API è°ƒç”¨å¤±è´¥ - URL æ ¼å¼é—®é¢˜** [åç«¯]
    - é—®é¢˜ï¼šå¯ç”¨ Agent åæŠ¥é”™ `'str' object has no attribute 'choices'`ï¼Œresponse è¿”å›çš„æ˜¯ HTML é¡µé¢
    - åŸå› ï¼šOpenAI å®¢æˆ·ç«¯çš„ `base_url` éœ€è¦ä»¥ `/v1` ç»“å°¾ï¼Œä½† `LLM_API_URL` ç¯å¢ƒå˜é‡åªè®¾ç½®äº† `http://43.159.131.233:3001`
    - ä¿®å¤ï¼š`AgentTrader/src/agent/trading_agent.py`
        - åœ¨ `_init_client()` ä¸­è‡ªåŠ¨æ£€æµ‹å¹¶è¡¥å…¨ `/v1` è·¯å¾„
        - ä¾‹å¦‚ï¼š`http://43.159.131.233:3001` â†’ `http://43.159.131.233:3001/v1`

**Agent æœªåˆå§‹åŒ–é—®é¢˜** [åç«¯]
    - é—®é¢˜ï¼šå¯ç”¨ Agent åå›æµ‹ä¸€ç›´æ˜¾ç¤º"Agent æœªåˆå§‹åŒ–ï¼Œè·³è¿‡åˆ†æ"
    - åŸå› ï¼šAPI æœåŠ¡å¯åŠ¨æ—¶æœªè°ƒç”¨ `init_agent()` åˆå§‹åŒ– Agent å®ä¾‹
    - ä¿®å¤ï¼š`AgentTrader/main.py`
        - åœ¨ lifespan ä¸­æ·»åŠ  `init_agent(settings.model_dump())` è°ƒç”¨
    - æ³¨æ„ï¼šéœ€è¦é…ç½® `config.yaml` ä¸­çš„ `agent.api_key` æ‰èƒ½æ­£å¸¸ä½¿ç”¨ Agent åŠŸèƒ½

**Agent é…ç½®åŒºå¸ƒå±€è·³åŠ¨é—®é¢˜** [å‰ç«¯]
    - é—®é¢˜ï¼šAgent å‹¾é€‰æ¡†å’Œæ–‡æœ¬ä¸å¯¹é½ï¼›å‹¾é€‰åæ£€æµ‹å‘¨æœŸè¾“å…¥æ¡†å¼¹å‡ºå¯¼è‡´å¸ƒå±€æ”¹å˜
    - ä¿®å¤ï¼š`src/pages/backtest/BacktestStream.tsx` + `BacktestStream.css`
        - å°† Agent é…ç½®æ”¹ä¸ºå•è¡Œå¸ƒå±€ï¼šå·¦ä¾§å‹¾é€‰æ¡† + å³ä¾§æ£€æµ‹å‘¨æœŸè¾“å…¥
        - æ£€æµ‹å‘¨æœŸè¾“å…¥å§‹ç»ˆæ˜¾ç¤ºï¼Œæœªå¯ç”¨æ—¶ç½®ç°ç¦ç”¨
        - é¿å…ä»»ä½•ä¼šæ”¹å˜å¸ƒå±€é«˜åº¦çš„åŠ¨æ€åˆ‡æ¢

**ç­–ç•¥å¡ç‰‡"å·²é€‰æ‹©"æ ‡è®°å¸ƒå±€é—®é¢˜** [å‰ç«¯]
    - é—®é¢˜ï¼šç³»ç»Ÿç­–ç•¥é€‰ä¸­ååº•éƒ¨æ˜¾ç¤º"å·²é€‰æ‹©"ä¼šæ”¹å˜å¡ç‰‡é«˜åº¦ï¼Œå¯¼è‡´ä¸‹æ–¹å†…å®¹è·³åŠ¨ï¼›ç”¨æˆ·ç­–ç•¥å¡ç‰‡æ²¡æœ‰é€‰ä¸­æ ‡è®°
    - ä¿®å¤ï¼š
        - `src/components/StrategyCard.css`ï¼šæ”¹ç”¨ç»å¯¹å®šä½ï¼Œåœ¨å¡ç‰‡å³ä¸Šè§’æ˜¾ç¤ºé€‰ä¸­æ ‡è®°
        - `src/pages/Dashboard.tsx`ï¼šä¸ºç”¨æˆ·ç­–ç•¥å¡ç‰‡æ·»åŠ ç›¸åŒçš„é€‰ä¸­æ ‡è®°
        - `src/pages/Dashboard.css`ï¼šæ·»åŠ ç”¨æˆ·ç­–ç•¥é€‰ä¸­æ ‡è®°æ ·å¼

**ä¸‹æ‹‰æ¡†å’Œæ—¥æœŸé€‰æ‹©å™¨é»‘æ¡†é—ªç°é—®é¢˜** [å‰ç«¯]
    - é—®é¢˜ï¼šç‚¹å‡»ä¸‹æ‹‰æ¡†æˆ–æ—¥æœŸé€‰æ‹©å™¨æ—¶ä¼šå…ˆé—ªç°é»‘æ¡†
    - åŸå› ï¼šæµè§ˆå™¨åœ¨æš—è‰²æ¨¡å¼ä¸‹æ¸²æŸ“è¡¨å•å…ƒç´ 
    - ä¿®å¤ï¼š
        - `src/index.css`ï¼šåœ¨ `:root` æ·»åŠ  `color-scheme: light` å¼ºåˆ¶äº®è‰²ä¸»é¢˜
        - `src/pages/backtest/BacktestStream.css`ï¼šä¸ºè¡¨å•å…ƒç´ æ·»åŠ  `color-scheme: light` å’Œ option æ ·å¼

**ä¸‹æ‹‰æ¡†å’Œæ—¥æœŸé€‰æ‹©å™¨æ ·å¼é—®é¢˜** [å‰ç«¯]
    - é—®é¢˜ï¼šæœŸè´§å“ç§ä¸‹æ‹‰æ¡†å’Œæ—¥æœŸé€‰æ‹©å™¨ä¼šé—ªé»‘æ¡†ï¼Œæ ·å¼ä¸åè°ƒ
    - ä¿®å¤ï¼š`src/pages/backtest/BacktestStream.css`
        - ä½¿ç”¨ `-webkit-appearance: none` ç§»é™¤åŸç”Ÿæ ·å¼
        - è‡ªå®šä¹‰ä¸‹æ‹‰ç®­å¤´ SVG å›¾æ ‡
        - æ·»åŠ  focus çŠ¶æ€æ ·å¼å’Œè¿‡æ¸¡åŠ¨ç”»
        - ä¼˜åŒ–æ—¥æœŸé€‰æ‹©å™¨çš„æ—¥å†å›¾æ ‡é€æ˜åº¦

**ä¿å­˜ç­–ç•¥ 404 é”™è¯¯** [åç«¯]
    - é—®é¢˜ï¼š`GET /api/strategies` è¿”å› 404
    - åŸå› ï¼šæ•°æ®åº“æ–‡ä»¶å·²å­˜åœ¨æ—¶ä¸ä¼šè°ƒç”¨ `init_tables()`ï¼Œå¯¼è‡´æ–°å¢çš„ `user_strategies` è¡¨æœªåˆ›å»º
    - ä¿®å¤ï¼š`AgentTrader/src/monitor/database.py`
        - `init_database()` æ”¹ä¸ºæ€»æ˜¯è°ƒç”¨ `init_tables()`
        - SQLAlchemy çš„ `create_all()` æ˜¯å¹‚ç­‰çš„ï¼Œå·²å­˜åœ¨çš„è¡¨ä¸ä¼šé‡å»º

**ç™»å½•é”™è¯¯æ¶ˆæ¯ä¸€é—ªè€Œè¿‡** [å‰ç«¯]
    - é—®é¢˜ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯æ—¶è­¦å‘Šä¸€é—ªè€Œè¿‡
    - åŸå› ï¼šAPI é”™è¯¯ä¿¡æ¯æœªæ­£ç¡®ä» axios å“åº”ä¸­æå–
    - ä¿®å¤ï¼š`src/stores/authStore.ts` æ”¹è¿›é”™è¯¯æå–é€»è¾‘ï¼Œä» `error.response.data.message` æ­£ç¡®è·å–
   
**æœªé€‰æ‹©ç­–ç•¥æ—¶æ— æç¤º** [å‰ç«¯]
    - é—®é¢˜ï¼šç‚¹å‡»"å›æµ‹"ç›´æ¥è·³è½¬ Dashboardï¼Œç”¨æˆ·å›°æƒ‘
    - ä¿®å¤ï¼šæ·»åŠ  Toast ç»„ä»¶ï¼Œè·³è½¬å‰æ˜¾ç¤º"è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­–ç•¥"æç¤º
    - æ–°å¢æ–‡ä»¶ï¼š`src/components/Toast.tsx`, `src/components/Toast.css`
    - ä¿®æ”¹ï¼š`src/stores/strategyStore.ts` æ·»åŠ  toast çŠ¶æ€ï¼Œ`src/App.tsx` æ·»åŠ å…¨å±€ Toast

**å›æµ‹ API å‚æ•°ä¸åŒ¹é…** [åç«¯]
    - é—®é¢˜ï¼š`run_backtest() got an unexpected keyword argument 'strategy_name'`
    - åŸå› ï¼šAPI è°ƒç”¨å‚æ•°ä¸å‡½æ•°ç­¾åä¸åŒ¹é…
    - ä¿®å¤ï¼š
        - `AgentTrader/src/api/routers/trade.py`ï¼šæ­£ç¡®æ„å»º config å’Œ strategy å¯¹è±¡
        - `AgentTrader/src/strategy/backtest.py`ï¼šæ·»åŠ  user_id æ”¯æŒ

**å›æµ‹ä¸‹å•å¤±è´¥ "ä¸åœ¨å¯äº¤æ˜“æ—¶é—´æ®µå†…"** [åç«¯]
    - é—®é¢˜ï¼šæ—¥çº¿æ—¶é—´æˆ³ï¼ˆ18:00ï¼‰ä¸åœ¨æœŸè´§äº¤æ˜“æ—¶æ®µï¼ŒTqSim æ‹’ç»ä¸‹å•
    - åŸå› ï¼šåŸå›æµ‹ä¾èµ– TqSim çš„è®¢å•æ’®åˆï¼Œä½†æ—¥çº¿æ•°æ®æ—¶é—´æˆ³è¶…å‡ºäº¤æ˜“æ—¶æ®µ
    - ä¿®å¤ï¼š`AgentTrader/src/strategy/backtest.py` ç®€åŒ–å›æµ‹é€»è¾‘
        - ç§»é™¤ TqSim è´¦æˆ·ä¾èµ–ï¼Œç›´æ¥ä½¿ç”¨ TqBacktest è·å–å†å²æ•°æ®
        - åŸºäºç­–ç•¥ä¿¡å·é…å¯¹è®¡ç®—ç›ˆäºï¼ˆBUY å¼€å¤š â†’ SELL å¹³å¤šï¼Œåä¹‹äº¦ç„¶ï¼‰
        - è‡ªè¡Œç»´æŠ¤æƒç›Šæ›²çº¿å’Œç»Ÿè®¡è®¡ç®—
    - ç»“æœï¼šå›æµ‹ä¸å†å‡ºç°"ä¸‹å•å¤±è´¥"è­¦å‘Šï¼Œç»Ÿè®¡æ•°æ®å‡†ç¡®

**å¼¹çª—æ ·å¼é—®é¢˜**
    - åˆ›å»ºé€šç”¨ `Modal` ç»„ä»¶ (`src/components/Modal.tsx`)
    - æä¾› `Modal` åŸºç¡€å¼¹çª—å’Œ `ConfirmModal` ç¡®è®¤å¼¹çª—
    - ç°ä»£åŒ–æ ·å¼ï¼šåœ†è§’ã€é˜´å½±ã€åŠ¨ç”»ã€åŠé€æ˜é®ç½©
    - æ›¿æ¢ `BacktestStream.tsx` ä¸­çš„ä¿å­˜å¼¹çª—
    - æ›¿æ¢ `Favorites.tsx` ä¸­çš„ `window.confirm` ä¸º `ConfirmModal`

**å›æµ‹è´¢åŠ¡ä¿¡æ¯å¢å¼º**
    - åç«¯ `backtest.py` `run_stream` æ–¹æ³•å¢åŠ è´¢åŠ¡è¿½è¸ªï¼š
    - æ¯ç¬”äº¤æ˜“è¿”å›: `balance`(ä½™é¢), `trade_pnl`(å¹³ä»“ç›ˆäº), `realized_pnl`(ç´¯è®¡ç›ˆäº), `floating_pnl`(æµ®åŠ¨ç›ˆäº), `market_value`(æŒä»“å¸‚å€¼)
    - åç«¯ SSE ç«¯ç‚¹å¢åŠ  `init_balance` å‚æ•°
    - å‰ç«¯ `backtestStore.ts` å¢åŠ  `initBalance` é…ç½®é¡¹
    - å‰ç«¯ `BacktestStream.tsx` æ–°å¢åˆå§‹èµ„é‡‘è¾“å…¥æ¡†
    - å‰ç«¯äº¤æ˜“æ¶ˆæ¯å¡ç‰‡å±•ç¤ºè¯¦ç»†è´¢åŠ¡ä¿¡æ¯

    **æ¶‰åŠæ–‡ä»¶**ï¼š
    - `src/components/Modal.tsx` (æ–°å¢)
    - `src/components/Modal.css` (æ–°å¢)
    - `src/pages/backtest/BacktestStream.tsx` (ä¿®æ”¹)
    - `src/pages/backtest/BacktestStream.css` (ä¿®æ”¹)
    - `src/pages/Favorites.tsx` (ä¿®æ”¹)
    - `src/stores/backtestStore.ts` (ä¿®æ”¹)
    - `AgentTrader/src/strategy/backtest.py` (ä¿®æ”¹)
    - `AgentTrader/src/api/routers/backtest.py` (ä¿®æ”¹)